<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    A:
    <select id = "aValues">
        <option value = "all">Toate</option>
        <option value = "A1">A1</option>
        <option value = "A2">A2</option>
        <option value = "A3">A3</option>
    </select>
    <br>
    B:
    <select id = "bValues">
        <option value = "all">Toate</option>
        <option value = "B1">B1</option>
        <option value = "B2">B2</option>
        <option value = "B3">B3</option>
        <option value = "B4">B4</option>
        <option value = "B5">B5</option>
        <option value = "B6">B6</option>
    </select>
    <br>
    C:
    <select id = "cValues">
        <option value = "all">Toate</option>
        <option value = "C1">C1</option>
        <option value = "C2">C2</option>
        <option value = "C3">C3</option>
        <option value = "C4">C4</option>
        <option value = "C5">C5</option>
        <option value = "C6">C6</option>
        <option value = "C7">C7</option>
        <option value = "C8">C8</option>
        <option value = "C9">C9</option>
        <option value = "C10">C10</option>
    </select>
    <br>
    <br>
    <div id = "optionsTable"></div>
    <script>
        const selectA = document.querySelector("#aValues");
        const selectB = document.querySelector("#bValues");
        const selectC = document.querySelector("#cValues");

        function filterTablesByOption(){
        document.getElementById('optionsTable').innerHTML = "";
        let optionA = selectA.value;
        let optionB = selectB.value;
        let optionC = selectC.value;
        let aVals = new Set();
        let bVals = new Set();
        let cVals = new Set();

        if (optionA === "all") optionA = "A";
        if (optionB === "all") optionB = "B";
        if (optionC === "all") optionC = "C";

        lines.forEach(line => {
            if (line.includes(optionA) && line.includes(optionB) && line.includes(optionC)){
                const newDiv = document.createElement("div");
                newDiv.textContent = line;
                optionsTable.appendChild(newDiv);

                currentValues = line.split(',');
                aVals.add(currentValues[0]);
                bVals.add(currentValues[1]);
                cVals.add(currentValues[2]);
            }
          });
          updateSelectBox(selectA, aVals);
          updateSelectBox(selectB, bVals);
          updateSelectBox(selectC, cVals);
    }
        function updateSelectBox(selector, updatedValues){
            const prev = selector.value;
            selector.innerHTML = (updatedValues.size == 1) ? "":'<option value="all">Toate</option>';
            
            if (updatedValues.size == 1){
                console.log(updatedValues);
                selector.innerHTML = "";
            }
            else{
                selector.innerHTML = '<option value="all">Toate</option>';
            }

            updatedValues.forEach(val =>{
                const opt = document.createElement("option");
                opt.value = val;
                opt.textContent = val;
                if (val === prev) opt.selected = val;
                selector.appendChild(opt);
        });
        }

        fetch("testData.txt")
.then(r=>r.text())
.then(text => {
    lines = text.split("\n");
    
    filterTablesByOption();
    selectA.addEventListener("change", filterTablesByOption);
    selectB.addEventListener("change", filterTablesByOption);
    selectC.addEventListener("change", filterTablesByOption);
});
      
    </script>
</body>
</html>